---
description: TDD로 기능 구현
---

# TDD Implementation Rules (Test-Driven Development)

이 문서는 프로젝트의 효율적이고 견고한 TDD 개발 프로세스를 위한 가이드라인이자 프롬프트입니다.

## 1. Core Workflow: Red-Green-Refactor

모든 기능 구현은 다음 3단계를 엄격히 따릅니다.

### Phase 1: Red (Failing Test)
- 구현하려는 기능의 **요구사항을 분석**하고, 이를 검증할 수 있는 **테스트 코드를 먼저 작성**합니다.
- 작성된 테스트는 컴파일 에러나 검증 실패로 인해 **반드시 실패**해야 합니다.
- 실패하는 것을 확인함으로써 테스트가 의도한 대로 동작함을 보장합니다.

### Phase 2: Green (Passing Test)
- 테스트를 통과하기 위한 **최소한의 코드**만 작성합니다.
- 올바른 디자인이나 패턴보다 **테스트 통과**를 최우선으로 합니다.
- 이 단계에서는 코드가 완벽하지 않아도 됩니다.

### Phase 3: Refactor (Clean Code)
- 테스트가 통과된 상태에서 코드를 개선합니다.
- 중복 제거, 가독성 향상, 구조 개선, `Clean Architecture` 원칙 적용 등을 수행합니다.
- **중요**: 리팩토링 중에도 **모든 테스트는 조작 없이 계속 통과**해야 합니다.

---

## 2. Test Coverage & Types

### 2.1 Coverage Goal
- **80% 이상의 커버리지**를 항상 유지해야 합니다.
- 새로운 코드가 추가될 때 커버리지가 떨어지지 않도록 주의합니다.

### 2.2 Test Scope
1. **Unit Test (단위 테스트)**:
   - 도메인 로직, 유틸리티 함수 등 작은 단위의 로직을 격리하여 테스트합니다.
   - Mocking을 적극 활용하여 외부 의존성을 배제합니다.
2. **Integration Test (통합 테스트)**:
   - 여러 모듈(예: UseCase + Repository) 간의 상호작용이 올바른지 검증합니다.
   - 실제 DB나 API와 유사한 환경을 사용하여 검증합니다.
3. **E2E Test (엔드투엔드 테스트)**:
   - 사용자의 실제 시나리오를 처음부터 끝까지 검증합니다.
   - 핵심 비즈니스 플로우(예: 로그인 -> 상품 조회 -> 주문)는 반드시 E2E로 커버합니다.

---

## 3. Failure Handling Process

구현 후 테스트 수행 시 실패가 발생하면 다음 절차를 따릅니다:

1. **Analyze (분석)**: 에러 로그와 테스트 코드를 기반으로 실패 원인을 정밀 분석합니다.
2. **Fix (수정)**: 분석된 원인을 해결하는 코드를 작성합니다.
3. **Verify (검증)**: 수정 후 전체 테스트를 다시 실행하여 Regression(회귀 버그)이 없는지 확인합니다.
4. **Repeat**: 모든 테스트가 통과(All Green)할 때까지 위 과정을 반복합니다.

---

## 4. AI Prompt for TDD (Copy & Use)

AI에게 작업을 요청할 때, 아래 프롬프트를 사용하여 TDD 절차를 강제하십시오.

> **Role & Objective**:
> 당신은 TDD(Test-Driven Development) 전문가입니다. 요청받은 기능을 구현할 때, **Red-Green-Refactor** 사이클을 엄격히 준수하여 진행해 주십시오.
>
> **Requirements**:
> 1. **Red**: 실제 코드를 작성하기 전에, 먼저 요구사항을 검증하는 **실패하는 테스트 코드**를 작성하십시오.
> 2. **Green**: 테스트를 통과하기 위한 최소한의 구현 코드를 작성하십시오.
> 3. **Refactor**: 코드를 정리하고 아키텍처 원칙에 맞게 리팩토링하십시오. (기능 변경 없음)
> 4. **Test Types**: Unit, Integration, E2E 테스트를 적절히 조합하여 작성하십시오.
> 5. **Coverage**: 전체 코드 커버리지가 **80% 이상**이 되도록 보장하십시오.
> 6. **Verification**: 구현 완료 후 모든 테스트를 실행하고 결과를 확인하십시오.
>    - 만약 테스트가 하나라도 실패한다면, 실패 원인을 **심층 분석**하고 수정하여 100% 통과를 만들어 내십시오.
